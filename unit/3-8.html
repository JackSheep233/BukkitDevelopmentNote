<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>世界生成器 | Bukkit Development Note</title>
    <meta name="description" content="A guide to develop Minecraft Server plugins based on Bukkit.">
    <meta name="generator" content="VuePress 1.4.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.2/jquery.fancybox.min.css">
    
    <link rel="preload" href="/BukkitDevelopmentNote/assets/css/0.styles.306dc64a.css" as="style"><link rel="preload" href="/BukkitDevelopmentNote/assets/js/app.2634dd99.js" as="script"><link rel="preload" href="/BukkitDevelopmentNote/assets/js/2.cc6e75aa.js" as="script"><link rel="preload" href="/BukkitDevelopmentNote/assets/js/28.ed2628f6.js" as="script"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/10.e1cfcf7a.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/11.44efa5f5.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/12.3917c9a1.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/13.848a50a7.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/14.d3d0e1c2.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/15.3d1313bf.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/16.4dd55a1e.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/17.ece6e639.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/18.ac97681d.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/19.396f060b.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/20.90cd3f0c.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/21.f6b39766.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/22.938c6544.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/23.f53b8e95.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/24.c4052a83.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/25.f7321946.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/26.548249ca.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/27.e2b64422.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/29.1c742d23.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/3.c1f93749.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/30.04dcb996.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/31.b2bccbe9.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/32.6ab03692.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/33.222886c9.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/34.fe917ab1.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/35.c3502896.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/36.62f3d555.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/37.39042c08.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/38.d83a6a0c.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/4.2f54bf03.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/5.ec88f9e9.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/6.8d881c35.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/7.4444e5b6.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/8.4b9b39e0.js"><link rel="prefetch" href="/BukkitDevelopmentNote/assets/js/9.c2d8b702.js">
    <link rel="stylesheet" href="/BukkitDevelopmentNote/assets/css/0.styles.306dc64a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/BukkitDevelopmentNote/" class="home-link router-link-active"><!----> <span class="site-name">Bukkit Development Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/BukkitDevelopmentNote/home.html" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/BukkitDevelopmentNote/contribute.html" class="nav-link">
  贡献
</a></div><div class="nav-item"><a href="https://alpha.tdiant.net/donate.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  赞助
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/tdiant/BukkitDevelopmentNote" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub仓库
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/BukkitDevelopmentNote/home.html" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/BukkitDevelopmentNote/contribute.html" class="nav-link">
  贡献
</a></div><div class="nav-item"><a href="https://alpha.tdiant.net/donate.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  赞助
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/tdiant/BukkitDevelopmentNote" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub仓库
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/BukkitDevelopmentNote/home.html" class="sidebar-link">欢迎</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第一部分: 基本概念</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/BukkitDevelopmentNote/unit/1-1.html" class="sidebar-link">写在前面</a></li><li><a href="/BukkitDevelopmentNote/unit/1-2.html" class="sidebar-link">MC的服务端介绍</a></li><li><a href="/BukkitDevelopmentNote/unit/1-3.html" class="sidebar-link">代码中的MC世界</a></li><li><a href="/BukkitDevelopmentNote/unit/1-4.html" class="sidebar-link">检索需要的信息</a></li><li><a href="/BukkitDevelopmentNote/unit/1-5.html" class="sidebar-link">服务端与客户端</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第二部分: 基础内容</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/BukkitDevelopmentNote/unit/2-1.html" class="sidebar-link">最简单的插件</a></li><li><a href="/BukkitDevelopmentNote/unit/2-2.html" class="sidebar-link">事件的监听</a></li><li><a href="/BukkitDevelopmentNote/unit/2-3.html" class="sidebar-link">配置API</a></li><li><a href="/BukkitDevelopmentNote/unit/2-4.html" class="sidebar-link">命令执行器</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>第三部分: 进阶功能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/BukkitDevelopmentNote/unit/3-2.html" class="sidebar-link">自定义事件</a></li><li><a href="/BukkitDevelopmentNote/unit/3-3.html" class="sidebar-link">深入plugin.yml</a></li><li><a href="/BukkitDevelopmentNote/unit/3-4.html" class="sidebar-link">配置API的序列化和遍历</a></li><li><a href="/BukkitDevelopmentNote/unit/3-5.html" class="sidebar-link">多线程多任务框架</a></li><li><a href="/BukkitDevelopmentNote/unit/3-6.html" class="sidebar-link">自定义合成表</a></li><li><a href="/BukkitDevelopmentNote/unit/3-7.html" class="sidebar-link">粒子效果和音效播放</a></li><li><a href="/BukkitDevelopmentNote/unit/3-8.html" class="active sidebar-link">世界生成器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/BukkitDevelopmentNote/unit/3-8.html#简述世界生成" class="sidebar-link">简述世界生成</a></li><li class="sidebar-sub-header"><a href="/BukkitDevelopmentNote/unit/3-8.html#干涉population" class="sidebar-link">干涉Population</a></li><li class="sidebar-sub-header"><a href="/BukkitDevelopmentNote/unit/3-8.html#控制generation" class="sidebar-link">控制Generation</a></li></ul></li><li><a href="/BukkitDevelopmentNote/unit/3-9.html" class="sidebar-link">Title、Bar与计分板显示</a></li><li><a href="/BukkitDevelopmentNote/unit/3-10.html" class="sidebar-link">经验和成就</a></li><li><a href="/BukkitDevelopmentNote/unit/3-11.html" class="sidebar-link">插件系统基本玩法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第四部分: 常用依赖</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/BukkitDevelopmentNote/unit/4-1.html" class="sidebar-link">Vault</a></li><li><a href="/BukkitDevelopmentNote/unit/4-2.html" class="sidebar-link">ProtocolLib</a></li><li><a href="/BukkitDevelopmentNote/unit/4-3.html" class="sidebar-link">Bungeecord</a></li><li><a href="/BukkitDevelopmentNote/unit/4-4.html" class="sidebar-link">PlaceholderAPI</a></li><li><a href="/BukkitDevelopmentNote/unit/4-5.html" class="sidebar-link">VexView</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>第五部分: 底层部分</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/BukkitDevelopmentNote/unit/5-1.html" class="sidebar-link">认识NMS与OBC</a></li><li><a href="/BukkitDevelopmentNote/unit/5-2.html" class="sidebar-link">自定义发包</a></li><li><a href="/BukkitDevelopmentNote/unit/5-3.html" class="sidebar-link">NBT数据操作</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="世界生成器"><a href="#世界生成器" class="header-anchor">#</a> 世界生成器</h1> <blockquote><p>本章编写参考了如下内容, 这篇文章对于插件开发而言十分重要:<br>
https://www.mcbbs.net/thread-811614-1-1.html</p></blockquote> <blockquote><p><a href="https://www.mcbbs.net/thread-846195-1-1.html" target="_blank" rel="noopener noreferrer">如果你对Minecraft 1.13中世界生成机制大改动感兴趣, 可以点击这里.<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br>
并且, <a href="https://www.zhihu.com/question/20754279" target="_blank" rel="noopener noreferrer">对于Minecraft 1.13之前版本的世界生成阐述, 可以见此文<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><em>在Bukkit中, 截止到目前, BukkitAPI仍沿用旧有规则的API.</em><br> <em>这意味着本文内容截止目前对于新版本的插件开发仍然有效.</em></p></blockquote> <p>本文中使用了<code>Material.GRASS_BLOCK</code>, 这是1.13版本的新用法.<br>
在旧版API中, 应该使用<code>Material.GRASS</code>.</p> <h2 id="简述世界生成"><a href="#简述世界生成" class="header-anchor">#</a> 简述世界生成</h2> <p>Minecraft中, 一个世界(World)按照一定的大小被分为多个区块(Chunk).<br>
MC会自动地按照一定的规则卸载无人Chunk, 在需要的时候加载所需的Chunk到内存, 以此来保证一个World被加载到内存, 这样不至于整个World都需要加载到内存以备调用.<br>
世界的生成同样以Chunk为单位.</p> <p>Minecraft游戏中, 世界生成分为两个阶段, 分别为 Generation 与 Population.</p> <p>Minecraft生成一个World, 首先进入 Generation 阶段. 这一阶段主要是绘制地形等.</p> <ol><li>Minecraft首先会获取该Chunk中包含的所有生物群系. 然后会根据特定的生物群系绘制基本的地形. 地形的绘制依靠了一些特殊的算法, 游戏通常会以高度63作为水平面, 通过这些特殊算法绘制基本的地形. 绘制完毕后, 整个世界只有空气、水和石头.</li> <li>接着会在高度0-5范围内生成基岩, 并逐个对各个生物群系添加特有的方块. 例如, 对平原添加草方块和泥土, 对沙漠添加沙子和沙石等.</li> <li>再然后会生成特殊地形. 这里的特殊地形指的是涉及到多个区块的大型地形, 例如规模很大的洞穴、村庄、矿井等.</li> <li>最后会进一步处理, 做最后的准备收尾工作, 至此Generation阶段完毕.</li></ol> <p>Generation阶段完成, 意味着该世界的整体结构已经定型. 但是这个世界上还缺少“点缀”. 这个世界上仍然没有树、生物、沼泽上的荷叶、水边的甘蔗等. 此时进入 Population 阶段.</p> <ol><li>首先会对该世界的实体进行完善, 并生成各种各样的特殊的方块(指的是箱子等方块实体, 这些方块与其它方块相比复杂许多).</li> <li>然后会生成小型地形. 比如一些地表小水坑、地表岩浆池、地下地牢等.</li> <li>然后会在地下按照一定的规则生成矿物.</li> <li>最后增加地面点缀, 生成水边的甘蔗、沼泽上的荷叶、地面大蘑菇和树木等物, 并增加一些生物群系特定物, 生成一些基础生物(比如牛、鸡、羊等).</li></ol> <p>待 Population 阶段结束后, 该Chunk的数据便会存储起来, 显示出来.</p> <h2 id="干涉population"><a href="#干涉population" class="header-anchor">#</a> 干涉Population</h2> <p>Bukkit中, 在世界初始化前会触发<code>WorldInitEvent</code>事件. 监听该事件, 我们可以对该世界生成的 Population 阶段进行干涉.</p> <p>在下面的案例中, 我们将在Chunk的 Population 阶段, 在世界的草方块上人为的添加许多钻石块(DIAMOND_BLOCK).</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WorldListener</span> <span class="token keyword">implements</span> <span class="token class-name">Listener</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@EventHandler</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onWorldInit</span><span class="token punctuation">(</span><span class="token class-name">WorldInitEvent</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            e<span class="token punctuation">.</span><span class="token function">getWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPopulators</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RuaPopulator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">RuaPopulator</span> <span class="token keyword">extends</span> <span class="token class-name">BlockPopulator</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">populate</span><span class="token punctuation">(</span><span class="token class-name">World</span> w<span class="token punctuation">,</span> <span class="token class-name">Random</span> r<span class="token punctuation">,</span> <span class="token class-name">Chunk</span> c<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> maxn <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span> <span class="token comment">//一个区块的X或Y范围是0-16</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">12</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//这里打算一个区块生成12个</span>
            <span class="token keyword">int</span> x <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>maxn<span class="token punctuation">)</span><span class="token punctuation">,</span> z <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>maxn<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">125</span><span class="token punctuation">;</span> y <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> y<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">getBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Material</span><span class="token punctuation">.</span>GRASS_BLOCK <span class="token operator">&amp;&amp;</span> c<span class="token punctuation">.</span><span class="token function">getBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Material</span><span class="token punctuation">.</span>AIR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    c<span class="token punctuation">.</span><span class="token function">getBlock</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">Material</span><span class="token punctuation">.</span>DIAMOND_BLOCK<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>最终效果如下:</p> <p><img src="https://i.loli.net/2020/02/08/AkEZ7VuOv8wWjKm.jpg" alt=""></p> <p>可以发现, 生成的world中, 按照我们的设定, 在地表草方块上零散的分布了钻石块.<br>
这说明在Bukkit中, 你可以创建一个BlockPopulator对象, 在世界初始化时添加为某一World的Populator, 依此来干涉Population阶段.<br> <em>Bukkit中的Populator只有BlockPopulator一种.</em><br> <em>但是你可以以此类推, 通过这种方式实现在地面随机生成某种建筑等其他效果.</em></p> <p>值得注意的是, 在自定义的Populator中, populate方法的参数中有一个传入的Random对象.<br>
这是为了让随机数的生成符合World对应的种子. 在需要生成随机数的时候, 应尽可能使用方法参数中的Random对象.</p> <h2 id="控制generation"><a href="#控制generation" class="header-anchor">#</a> 控制Generation</h2> <p>通过控制一个世界的Generation, 我们可以控制世界的大体地形.<br>
下面我们将在插件加载时, 生成一个新的世界<code>RuaWorld</code>, 这个世界是一个超平坦世界, 第一第二层为基岩, 第三层为草方块.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token keyword">extends</span> <span class="token class-name">JavaPlugin</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onEnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Bukkit</span><span class="token punctuation">.</span><span class="token function">getPluginManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">registerEvents</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WorldListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Bukkit</span><span class="token punctuation">.</span><span class="token function">createWorld</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WorldCreator</span><span class="token punctuation">(</span><span class="token string">&quot;RuaWorld&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">generator</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RuaChunkGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onDisable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">RuaChunkGenerator</span> <span class="token keyword">extends</span> <span class="token class-name">ChunkGenerator</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ChunkData</span> <span class="token function">generateChunkData</span><span class="token punctuation">(</span><span class="token class-name">World</span> w<span class="token punctuation">,</span> <span class="token class-name">Random</span> r<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> z<span class="token punctuation">,</span> <span class="token class-name">BiomeGrid</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ChunkData</span> chunkData <span class="token operator">=</span> <span class="token function">createChunkData</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建区块数据</span>

        <span class="token comment">//下面这行方法调用参数中, 前三个参数代表一个XYZ对, 后面又是一个XYZ对.</span>
        <span class="token comment">//这两个XYZ对是选区的意思, 你可以结合Residence插件圈地、WorldEdit选区的思路思考.</span>
        <span class="token comment">//提醒: 一个Chunk的X、Z取值是0-16, Y取值是0-255.</span>
        chunkData<span class="token punctuation">.</span><span class="token function">setRegion</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token class-name">Material</span><span class="token punctuation">.</span>BEDROCK<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//填充基岩</span>
        chunkData<span class="token punctuation">.</span><span class="token function">setRegion</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token class-name">Material</span><span class="token punctuation">.</span>GRASS_BLOCK<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//填充草方块</span>
        
        <span class="token comment">//将整个区块都设置为平原生物群系(PLAINS)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                b<span class="token punctuation">.</span><span class="token function">setBiome</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> <span class="token class-name">Biome</span><span class="token punctuation">.</span>PLAINS<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> chunkData<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="https://i.loli.net/2020/02/08/yTaJ1z7A2j4dkB6.jpg" alt=""></p> <p><img src="https://i.loli.net/2020/02/08/6wiDNdl8y3AmJFh.jpg" alt=""></p> <p>我们进入<code>RuaWorld</code>世界, 可以发现世界按照我们所需要的地形生成了.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/BukkitDevelopmentNote/unit/3-7.html" class="prev">
        粒子效果和音效播放
      </a></span> <span class="next"><a href="/BukkitDevelopmentNote/unit/3-9.html">
        Title、Bar与计分板显示
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/BukkitDevelopmentNote/assets/js/app.2634dd99.js" defer></script><script src="/BukkitDevelopmentNote/assets/js/2.cc6e75aa.js" defer></script><script src="/BukkitDevelopmentNote/assets/js/28.ed2628f6.js" defer></script>
  </body>
</html>
